‚úÖ FULL UPDATED FILE ‚Äî COPY & PASTE THIS ENTIRE FILE
import { useMemo } from "react";
import { Shield, Plus } from "lucide-react";
import { Popover, PopoverContent, PopoverTrigger } from "@/components/ui/popover";
import { normalizeBadges } from "./healthBadges";

export default function HealthBadgesPopover({
  badges,
  label = "Medical badges",
  className = "",
  align = "center",
  side = "top",
}: {
  badges?: string[];
  label?: string;
  className?: string;
  align?: "start" | "center" | "end";
  side?: "top" | "right" | "bottom" | "left";
}) {
  const items = useMemo(() => normalizeBadges(badges), [badges]);
  const count = items.length;

  return (
    <div className={className}>
      <Popover>
        <PopoverTrigger asChild>
          <button
            className="bg-lime-700 hover:bg-lime-800 border-2 border-lime-600 text-white rounded-xl w-5 h-5 flex items-center justify-center text-sm font-bold relative"
            data-testid="button-medical-badges"
            title={label}
          >
            {/* NEW ICON: Shield + Red Medical Cross */}
            <div className="relative w-4 h-4 flex items-center justify-center">
              {/* Shield icon */}
              <Shield className="w-4 h-4 text-white" strokeWidth={2} />

              {/* Red medical cross overlay */}
              <Plus
                className="w-2 h-2 text-red-500 absolute"
                strokeWidth={3}
              />
            </div>
          </button>
        </PopoverTrigger>

        <PopoverContent
          align={align}
          side={side}
          sideOffset={8}
          className="rounded-2xl bg-black/90 text-white border border-white/10 shadow-lg max-w-xs p-4 space-y-2 text-sm z-50"
        >
          <div className="font-semibold mb-2 text-white/90">
            {count === 0 ? "Medical Badges" : `Medical Badges (${count})`}
          </div>

          {count === 0 ? (
            <div
              className="text-white/60 text-xs"
              data-testid="text-no-badges"
            >
              No health badges for this meal.
            </div>
          ) : (
            items.map(item => (
              <div
                key={item.key}
                className="flex items-start gap-2"
                data-testid={`badge-row-${item.key}`}
              >
                <span className="inline-flex h-2 w-2 rounded-full bg-white/70 mt-1.5 flex-shrink-0" />
                <div>
                  <div
                    className="font-medium"
                    data-testid={`text-badge-label-${item.key}`}
                  >
                    {item.label}
                  </div>
                  {item.desc && (
                    <div
                      className="text-white/80 text-xs"
                      data-testid={`text-badge-desc-${item.key}`}
                    >
                      {item.desc}
                    </div>
                  )}
                </div>
              </div>
            ))
          )}
        </PopoverContent>
      </Popover>
    </div>
  );
}

üéâ WHAT THIS UPDATE DOES
‚úî Replaces the tiny ‚Äú?‚Äù with a medical badge that looks official and urgent
‚úî Uses a Shield icon (medical protection symbol)
‚úî Adds a red medical cross overlay (instant recognition)
‚úî Keeps the same footprint + styles
‚úî Blends perfectly with your dark UI
‚úî Users will NOT ignore this badge anymore

Every meal with medical tags will now show this:

üõ°Ô∏è‚ù§Ô∏è‚ûï
instead of
?

Game changer.