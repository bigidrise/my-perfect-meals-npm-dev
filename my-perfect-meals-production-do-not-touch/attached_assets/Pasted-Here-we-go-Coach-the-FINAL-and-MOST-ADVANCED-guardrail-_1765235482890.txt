Here we go, Coach â€” the **FINAL and MOST ADVANCED guardrail system** in your entire architecture:

# ğŸ”¥ **PHASE 3.7 â€” PROCARE GUARDRAILS (TRAINER + DOCTOR PRESETS)**

This is the highest-stakes builder because **ProCare is NOT a â€œdiet type.â€**
It is a **professional supervision environment** where:

* Trainers
* Doctors
* Clinics
* Hospital partners

â€¦set **custom macros**, **custom ingredient rules**, **custom exclusions**, and **custom nutritional targets** **unique to each client.**

This means ProCare guardrails are the **ONLY fully dynamic guardrails** in your entire system.

This prompt ensures the architect understands that.

---

# âœ… **ARCHITECT PROMPT â€” PHASE 3.7: PROCARE GUARDRAILS (TRAINER + DOCTOR PRESETS)**

**Architect â€” GLP-1 guardrails are complete.
Begin Phase 3.7: ProCare Guardrails.
Load full project context including:

* Create With Chef
* Snack Creator
* Unified MealCard
* Anti-Inflammatory, Diabetic, BeachBody, General, GLP-1 guardrails
* ProCare schema (doctor + coach presets, target macros, exclusions, preferences)**

---

# ğŸ¯ **WHY PROCARE IS DIFFERENT FROM ALL OTHER GUARDRAILS**

Anti-inflammatory, diabetic, etc. use *preset rules.*

**ProCare does NOT.**
ProCare is **customized per client**, using:

* Trainer-defined macros
* Doctor-defined medical exclusions
* Preset dietary modes (Cardiac, Diabetes, GLP-1, Anti-Inflammatory, etc.)
* Ingredient blocklists
* Ingredient whitelists
* Cooking method restrictions
* Portion-size enforcement
* Custom targets (protein per meal, daily calories, etc.)

The ProCare guardrail engine must be able to read these **dynamic per-client rules** and enforce them when generating meals/snacks.

This is a flexible rule system â€” NOT a fixed one.

---

# ğŸ§± **PROCARE GUARDRAIL INPUTS (THE â€œRULE PACKâ€)**

Each ProCare client will have a **Rule Pack**, which includes:

```
{
  dietType: "<assigned preset or custom>",
  macroTargets: { protein, carbs, fats, caloriesPerDay, caloriesPerMeal },
  ingredientBlacklist: [...],
  ingredientWhitelist: [...],
  portionMultiplier: <value>,
  cookingConstraints: ["no oil", "low sodium", etc.],
  mealFrequency: <value>,
  proteinPerMeal: <calculated target>,
  coachCustomNotes: "<behavioral notes>",
  doctorRestrictions: "<strict medical exclusion list>"
}
```

The architect must pass this **entire object** into the generation pipeline.

---

# ğŸ”¥ **WHAT MUST BE ENFORCED (PROCARE RULESET)**

## âŒ ABSOLUTE MUST-NOT-GENERATE (Derived From Rule Pack)

* Any ingredient on the **trainer blacklist**
* Any ingredient on the **doctor blacklist**
* Any ingredient restricted by **medical presets**
  (diabetic, cardiac, anti-inflammatory, GLP-1, etc.)
* Anything exceeding prescribed macros
* Anything exceeding sodium/cooking restrictions
* Anything conflicting with **meal frequency protein targets**

---

## âœ” MUST ALWAYS BE ENFORCED (Fixed ProCare Rules)

Regardless of the coach or doctor settings, ProCare must always ensure:

### HIGH PROTEIN MEALS

Protein must be distributed by:

```
finalProtein = macroTargets.protein / mealFrequency
```

### CLEAN INGREDIENTS

No junk foods, no desserts, no processed meals.

### LOW-MODERATE FAT

Unless doctor overrides.

### CARB TIMING

If coach assigned carb timing (training days vs non-training days), enforce it.

### COOKING METHODS

Allowed only:

* grill
* bake
* steam
* air fry
  Minimal oils unless trainer overrides.

### OPTIONAL MEDICAL PRESETS

If a doctor assigns a preset (Cardiac, Diabetic, GLP-1, Anti-Inflammatory, etc.),
the system must combine:

```
ProCare rules + medical rules
```

This creates a **hybrid guardrail engine**, unique per client.

---

# ğŸ½ **SNACK CREATOR UNDER PROCARE**

Snacks MUST:

* Match macro targets
* Stay within carbs/fat limits
* Respect ingredient blacklists
* Respect medical presets
* Use clean, digestible ingredients
* Provide protein > carbs in most cases
* NEVER output candy, chips, pastries, or high-fat snacks

Examples:

**Allowed:**

* Greek yogurt (plain) + berries
* Cottage cheese + fruit
* Whey shake
* Rice cake + lean protein spread
* Chicken bites
* Tuna packet (no mayo)

**Never allowed:**

* Sugar snacks
* Junk foods
* High-fat snacks
* Bread/pastry-based snacks

---

# ğŸ§© **ARCHITECT IMPLEMENTATION DETAILS**

## **1ï¸âƒ£ ProCare guardrail detection**

Every Create With Chef and Snack Creator request inside ProCare must include:

```
dietType: "procare"
rulePack: <FULL client rule pack>
```

This is required.

---

## **2ï¸âƒ£ Pre-filtering stage**

Remove any ingredient that violates:

* doctorBlacklist
* coachBlacklist
* medicalPresetBlacklist
* sodium limit
* fat limits
* forbidden cooking methods

---

## **3ï¸âƒ£ Prompt rewriting**

Rewrite prompt with dynamic instructions:

Examples:

* â€œGenerate a meal using ONLY approved ingredients from the whitelist.â€
* â€œDo not use ingredients from the blacklist.â€
* â€œProtein target per meal: X grams.â€
* â€œCarbs must not exceed Y per meal.â€
* â€œFat must not exceed Z per meal.â€
* â€œCooking methods restricted to grill, steam, bake, air fry.â€
* â€œUser is under professional supervision; meals must be strict, clean, and macro-accurate.â€

---

## **4ï¸âƒ£ Post-generation validation**

AI output must be validated against:

* ingredient rules
* macro targets
* cooking constraints
* meal frequency protein distribution
* portion size

If any rule is violated â†’ **reject + regenerate** until compliant.

---

## **5ï¸âƒ£ Unified MealCard Output**

Do NOT change formatting.
Output must include:

* Image
* Expanded ingredients
* Instructions
* Serving size
* Macros
* Everything the same as all other builders

ProCare changes *content*, not *format*.

---

# ğŸ¯ **SUCCESS CRITERIA â€” PROCARE COMPLETE**

A ProCare meal/snack MUST:

### âœ” Follow trainer macros

### âœ” Follow doctor medical exclusions

### âœ” Follow ingredient rules

### âœ” Follow portion limits

### âœ” Follow cooking constraints

### âœ” Follow protein distribution

### âœ” Never violate medical presets

### âœ” Produce full meal cards

### âœ” Work with Create With Chef AND Snack Creator

When this system is complete, the guardrail architecture is FULLY implemented across all 7 builders.

---

# ğŸ Architect â€” begin Phase 3.7 (ProCare Guardrails) now.

Confirm when ProCare guardrails are active for meals & snacks.

---

Coach â€” after this, the Guardrail System is **DONE**, and your clinical + performance pipeline is world-class.

If you want the **Guardrail QA Test Plan** next, say:

**â€œQA plan.â€**
