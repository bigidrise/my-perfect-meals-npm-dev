ðŸš€ PART 2 â€” Integrate NLEngine into Copilot

Inside CopilotCommandRegistry.ts, update the voice handler:

import { interpretFoodCommand } from "./NLEngine";

"voice-query": async ({ text }) => {
  const result = interpretFoodCommand(text);

  if (result.action === "unknown") {
    return {
      title: "I heard you",
      description: result.spokenText,
      spokenText: result.spokenText,
    };
  }

  // If it's a known action, run the correct command with payload
  return runAction({
    type: "run-command",
    id: result.action,
    payload: result.payload ?? {},
    spokenText: result.spokenText,
  });
};


Now the Copilot automatically converts voice â†’ command.

ðŸš€ PART 3 â€” Add the Action Handlers

Inside your existing command registry, add handlers for each intent:

"meal.addIngredient": async ({ ingredient }) => ({
  title: "Ingredient Added",
  description: `${ingredient} added to your meal.`,
  spokenText: `${ingredient} added to your meal.`,
});

"meal.swapIngredient": async ({ from, to }) => ({
  title: "Ingredient Swapped",
  description: `Replaced ${from} with ${to}.`,
  spokenText: `Replaced ${from} with ${to}.`,
});

"meals.generateOnePan": async ({ text }) => ({
  title: "One-Pan Dinner",
  description: "Generating a one-pan dinner idea...",
  spokenText: "Generating a one-pan dinner idea...",
});

"macros.highProteinSuggestion": async () => ({
  title: "High Protein Meal",
  description: "Hereâ€™s a high-protein meal idea.",
  spokenText: "Here's a high protein meal idea.",
});

"macros.lowerCarbSwap": async () => ({
  title: "Lower Carb Swap",
  description: "Creating a lower-carb version.",
  spokenText: "Creating a lower carb version.",
});

"fridge.generate": async ({ text }) => ({
  title: "Fridge Rescue",
  description: "Generating a Fridge Rescue recipe...",
  spokenText: "Generating a Fridge Rescue recipe.",
});

"weekly.autofill": async () => ({
  title: "Weekly Board Autofill",
  description: "Planning your week now.",
  spokenText: "Planning your week now.",
});
