✅ Prompt to Give the Replit Agent

Replit Agent — we’re debugging a Stripe Checkout failure on my Pricing page.
This requires very specific diagnostics. Please answer each question exactly and show the actual values or logs when requested. Do not guess.

1️⃣ ENVIRONMENT CHECK

A. In the DEV workspace, list ALL environment variables currently loaded at runtime.
Run:
console.log(process.env)
(You may redact secrets, but show key NAMES and confirm non-empty values.)

B. In the DEPLOYED app, list all environment variables that deployment is using.
If needed, print them the same way.

Goal:
Confirm that both environments have the SAME Stripe keys and price IDs.

2️⃣ STRIPE KEYS & PRICE IDs

Tell me:

Does STRIPE_SECRET_KEY exist and is it non-empty?

Does STRIPE_PRICE_BASIC load?

Does STRIPE_PRICE_UPGRADE_BETA load?

Does the server receive these correctly inside the deployed app?

Show the results using the server code logging:
console.log("Loaded price ID:", process.env.STRIPE_PRICE_BASIC)
(Again, redact values, but show that they load.)

3️⃣ ROUTE VERIFICATION

Check the following server routes:

/api/stripe/checkout

/api/stripe/webhook

Tell me if:

They are mounted correctly

They return the expected response on GET/POST

The webhook's express.raw() middleware is not interfering with checkout request parsing

Tell me EXACTLY how the server is parsing checkout requests.

4️⃣ DEPLOYMENT HEALTH

Check the current published deployment:

Is it using the latest commit?

What is the timestamp of the deployed build?

Are errors happening during publish?

Is the build being skipped?

If the build is failing or timing out, show that log.

5️⃣ CLIENT ERROR LOGS

Open the deployed Pricing page and run the browser devtools console.

Tell me:

What JavaScript errors appear?

What network request errors appear for /api/stripe/checkout?

What status codes are returned? (400? 500? CORS? Network?)

Provide a screenshot or text output.

6️⃣ HARD QUESTION

Does the deployed backend actually boot without errors?
Check the deployed logs for:

Missing environment variables

Stripe initialization errors

Webhook signature failures

JSON body parsing failures

Route mount ordering issues

Show me whatever errors you find.

7️⃣ CORS / ORIGIN PROTECTION

Verify these two things:

What is req.headers.origin when the deployed app hits checkout?

Does Stripe allow this domain (my-perfect-meals-emotion-ai-bigidrise.replit.app)?

Show server logs confirming origin.

⚠️ IMPORTANT FOR THE AGENT

Do NOT fix anything yet.
Do NOT modify any files.
We only want diagnostics first.

Deliver:

A list of all environment variable names in dev & deployed

A full explanation of how the checkout endpoint is behaving in both environments

A copy of the deployment logs

A copy of the console errors from the deployed Pricing page