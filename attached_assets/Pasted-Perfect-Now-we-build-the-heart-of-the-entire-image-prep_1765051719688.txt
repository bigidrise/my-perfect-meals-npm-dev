Perfect. Now we build the heart of the entire image + prep system:

üß¨ PHASE 1 ‚Äî FILE #3

üìÅ ingredientTechniqueMappings.catalog.ts

This file answers the single most important question:

‚ÄúIf the user picks Salmon and the cooking method is pan-seared,
what image do we show, and is that combo allowed?‚Äù

This is the backbone of stable, deterministic meal rendering.

No AI guesswork.
No prompt drift.
No hallucination.
No mismatched visuals.
No ‚Äúscrambled eggs‚Äù showing up as sunny-side-up ever again.

You‚Äôll plug this into the hybrid engine so AI fills the blanks, but the catalog enforces reality.

‚∏ª

‚úîÔ∏è What This File Does

For every protein, carb, and egg item, it defines:
	‚Ä¢	allowed cooking methods
	‚Ä¢	blocked methods (pork cannot be medium-rare, yogurt cannot be grilled)
	‚Ä¢	default doneness rules
	‚Ä¢	imageKey = the EXACT static or cached image to use
	‚Ä¢	imageVariantRules = optional tweaks or specific photography variants

This file alone removes 80% of inconsistency.

‚∏ª

üìÅ ingredientTechniqueMappings.catalog.ts

// =====================================================================
// INGREDIENT ‚Üî TECHNIQUE MAPPING CATALOG
// Deterministic rules for how each food can be cooked and what image to show.
// =====================================================================

import { CookingMethodId } from "./techniques.catalog";

export interface IngredientTechniqueMapping {
  ingredientId: string; // lowercase canonical ID (ex: "chicken_breast")
  displayName: string;  // Human readable
  validMethods: CookingMethodId[];
  blockedMethods?: CookingMethodId[];
  defaultMethod?: CookingMethodId;

  // Deterministic image selection
  imageKeyMap: {
    [method in CookingMethodId]?: string;
  };

  // Optional rules for doneness modifiers
  allowedDoneness?: ("well-done" | "medium" | "medium-rare")[];
}

// Helpers for generating keys consistently
const key = (ingredient: string, method: string) =>
  `img_${ingredient.toLowerCase().replace(/\s+/g, "_")}_${method}`;

const ING = (x: string) => x.toLowerCase().replace(/\s+/g, "_");

// =====================================================================
// PROTEINS
// =====================================================================

export const PROTEIN_TECHNIQUE_MAPPINGS: IngredientTechniqueMapping[] = [
  // -------------------------------
  // CHICKEN BREAST
  // -------------------------------
  {
    ingredientId: ING("Chicken Breast"),
    displayName: "Chicken Breast",
    validMethods: [
      "air-fried",
      "baked",
      "grilled",
      "pan-seared",
      "boiled",
      "steamed",
    ],
    blockedMethods: ["medium", "medium-rare"], // food safety
    defaultMethod: "grilled",
    allowedDoneness: ["well-done"],

    imageKeyMap: {
      "air-fried": key("chicken_breast", "air_fried"),
      baked: key("chicken_breast", "baked"),
      grilled: key("chicken_breast", "grilled"),
      "pan-seared": key("chicken_breast", "pan_seared"),
      boiled: key("chicken_breast", "boiled"),
      steamed: key("chicken_breast", "steamed"),
    },
  },

  // -------------------------------
  // SALMON
  // -------------------------------
  {
    ingredientId: ING("Salmon"),
    displayName: "Salmon",
    validMethods: [
      "pan-seared",
      "grilled",
      "baked",
      "air-fried",
      "poached",
      "steamed",
    ],
    blockedMethods: ["fried"], // avoid
    defaultMethod: "pan-seared",
    allowedDoneness: ["well-done", "medium"],

    imageKeyMap: {
      "pan-seared": key("salmon", "pan_seared"),
      grilled: key("salmon", "grilled"),
      baked: key("salmon", "baked"),
      "air-fried": key("salmon", "air_fried"),
      poached: key("salmon", "poached"),
      steamed: key("salmon", "steamed"),
    },
  },

  // -------------------------------
  // EGGS
  // -------------------------------
  {
    ingredientId: ING("Eggs"),
    displayName: "Eggs",
    validMethods: ["scrambled", "fried", "poached", "boiled"],
    defaultMethod: "scrambled",

    blockedMethods: [
      "grilled",
      "air-fried",
      "pan-seared",
      "steamed",
      "baked",
      "medium",
      "medium-rare",
    ],

    imageKeyMap: {
      scrambled: key("eggs", "scrambled"),
      fried: key("eggs", "fried"),
      poached: key("eggs", "poached"),
      boiled: key("eggs", "boiled"),
    },
  },

  // -------------------------------
  // EGG WHITES
  // -------------------------------
  {
    ingredientId: ING("Egg Whites"),
    displayName: "Egg Whites",
    validMethods: ["scrambled", "fried", "steamed"],
    defaultMethod: "scrambled",
    blockedMethods: ["grilled", "air-fried", "poached", "baked"],

    imageKeyMap: {
      scrambled: key("egg_whites", "scrambled"),
      fried: key("egg_whites", "fried"),
      steamed: key("egg_whites", "steamed"),
    },
  },

  // -------------------------------
  // GROUND TURKEY
  // -------------------------------
  {
    ingredientId: ING("Ground Turkey"),
    displayName: "Ground Turkey",
    validMethods: [
      "pan-seared",
      "fried",
      "baked",
      "air-fried",
      "grilled",
      "boiled",
    ],
    defaultMethod: "pan-seared",
    blockedMethods: ["medium", "medium-rare"],

    allowedDoneness: ["well-done"],

    imageKeyMap: {
      "pan-seared": key("ground_turkey", "pan_seared"),
      fried: key("ground_turkey", "fried"),
      baked: key("ground_turkey", "baked"),
      "air-fried": key("ground_turkey", "air_fried"),
      grilled: key("ground_turkey", "grilled"),
      boiled: key("ground_turkey", "boiled"),
    },
  },

  // -------------------------------
  // SHRIMP
  // -------------------------------
  {
    ingredientId: ING("Shrimp"),
    displayName: "Shrimp",
    validMethods: [
      "pan-seared",
      "air-fried",
      "grilled",
      "baked",
      "poached",
      "steamed",
    ],
    blockedMethods: ["fried"], // keep healthy
    defaultMethod: "pan-seared",

    imageKeyMap: {
      "pan-seared": key("shrimp", "pan_seared"),
      grilled: key("shrimp", "grilled"),
      "air-fried": key("shrimp", "air_fried"),
      baked: key("shrimp", "baked"),
      poached: key("shrimp", "poached"),
      steamed: key("shrimp", "steamed"),
    },
  },
];

// =====================================================================
// STARCHY CARBS
// =====================================================================

export const STARCH_TECHNIQUE_MAPPINGS: IngredientTechniqueMapping[] = [
  {
    ingredientId: ING("Oats"),
    displayName: "Oats",
    validMethods: ["boiled"],
    defaultMethod: "boiled",

    imageKeyMap: {
      boiled: key("oats", "boiled"),
    },
  },
  {
    ingredientId: ING("Potatoes"),
    displayName: "Potatoes",
    validMethods: ["baked", "air-fried", "boiled", "steamed"],
    defaultMethod: "baked",

    imageKeyMap: {
      baked: key("potatoes", "baked"),
      "air-fried": key("potatoes", "air_fried"),
      boiled: key("potatoes", "boiled"),
      steamed: key("potatoes", "steamed"),
    },
  },
  {
    ingredientId: ING("Sweet Potatoes"),
    displayName: "Sweet Potatoes",
    validMethods: ["baked", "air-fried", "steamed"],
    defaultMethod: "baked",

    imageKeyMap: {
      baked: key("sweet_potatoes", "baked"),
      "air-air-fried": key("sweet_potatoes", "air_fried"),
      steamed: key("sweet_potatoes", "steamed"),
    },
  },
];

// =====================================================================
// FIBROUS CARBS
// =====================================================================

export const FIBROUS_TECHNIQUE_MAPPINGS: IngredientTechniqueMapping[] = [
  {
    ingredientId: ING("Broccoli"),
    displayName: "Broccoli",
    validMethods: ["steamed", "air-fried", "baked"],
    defaultMethod: "steamed",

    imageKeyMap: {
      steamed: key("broccoli", "steamed"),
      "air-fried": key("broccoli", "air_fried"),
      baked: key("broccoli", "baked"),
    },
  },
  {
    ingredientId: ING("Spinach"),
    displayName: "Spinach",
    validMethods: ["steamed"],
    defaultMethod: "steamed",
    imageKeyMap: {
      steamed: key("spinach", "steamed"),
    },
  },
];

// =====================================================================
// EXPORT UNION
// =====================================================================

export const INGREDIENT_TECHNIQUE_MAPPINGS: IngredientTechniqueMapping[] = [
  ...PROTEIN_TECHNIQUE_MAPPINGS,
  ...STARCH_TECHNIQUE_MAPPINGS,
  ...FIBROUS_TECHNIQUE_MAPPINGS,
];


‚∏ª

‚úîÔ∏è Why This Is Perfect for Your App

1. Every meal now has a guaranteed correct image

No more mismatches.
No more ‚ÄúAI guessed wrong.‚Äù

2. Every ingredient now has allowed cooking methods

No more ‚Äúgrilled yogurt‚Äù or ‚Äúmedium-rare chicken.‚Äù

3. Doneness rules prevent unsafe food

You‚Äôre a coach, you know this matters.
Apple reviewers notice this too.

4. Catalog is expandable

You can keep adding ingredients or new techniques.

5. This unlocks Tier 1 static image library

Because now you know exactly what images you actually need.

‚∏ª

Ready for the next file?

Next in the chain is:

üìÅ mealTemplates.catalog.ts

(the top 50‚Äì100 premade meals rewritten in the new template format)

Say next when you‚Äôre ready and I‚Äôll build it.